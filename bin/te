#!/bin/bash

# helper for the child terminal
_client_texenv() {
    silent i3-msg "resize shrink up"
    silent i3-msg "resize shrink up"
    silent i3-msg "resize shrink up"
    sleep .1
    silent i3-msg 'focus parent'
    sleep .1
    silent i3-msg 'split h'
    sleep .1
    clatexmk "$1"
}

svim "$1"

# Start LaTeX 'environment'
if [[ $(psgrep -n latexmk) == "" ]]; then
    i3-msg "split v"
    sleep .1
    terminator -e "source ~/.zshrc && _client_texenv '$1'" &
fi
